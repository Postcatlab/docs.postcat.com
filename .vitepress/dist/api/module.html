<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>模块开发指南 | Eoapi</title>
    <meta name="description" content="一个可拓展的开源 API 工具">
    <link rel="stylesheet" href="/assets/style.3e7c7b3f.css">
    <link rel="modulepreload" href="/assets/chunks/AlgoliaSearchBox.111ccfdd.js">
    <link rel="modulepreload" href="/assets/app.68c6bb90.js">
    <link rel="modulepreload" href="/assets/api_module.md.37005fae.lean.js">
    
    <link rel="icon" href="/favicon.ico">
  <script src="https://lf1-cdn-tos.bytegoofy.com/obj/iconpark/icons_10812_9.04dec48becbe244b12f6eca51b76db33.js"></script>
  <script src="/lib/medium-zoom.js"></script>
  <script src="/zoom-image.js"></script>
  <script>(function(t,c,o,e,s){t[s]=t[s]||function(){(t[s].q=t[s].q||[]).push(arguments)},o=c.createElement("script"),tag=c.getElementsByTagName("script")[0],o.async=1,o.src=(document.location.protocol=="https:"?"https://":"http://")+e,tag.parentNode.insertBefore(o,tag)})(window,document,"script","assets.giocdn.com/2.1/gio.js","gio"),gio("init","bd7645ddc19400a8",{}),gio("send");</script>
  <meta name="twitter:title" content="模块开发指南 | Eoapi">
  <meta property="og:title" content="模块开发指南 | Eoapi">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-40587210><div class="sidebar-button" data-v-40587210><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="Eoapi, back to home" data-v-40587210 data-v-016a8bd8><img class="logo" src="/images/logo.svg" alt="Logo" data-v-016a8bd8> Eoapi</a><div class="flex-grow" data-v-40587210></div><div class="nav" data-v-40587210><nav class="nav-links" data-v-40587210 data-v-35b91e7e><!--[--><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/index" data-v-49fe041d>首页 <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/docs/about" data-v-49fe041d>文档 <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/api/overview" data-v-49fe041d>API <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://demo.eoapi.io/" target="_blank" rel="noopener noreferrer" data-v-49fe041d>Live Demo <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://github.com/eolinker/eoapi" target="_blank" rel="noopener noreferrer" data-v-49fe041d>Github <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-35b91e7e><div class="nav-dropdown-link" data-v-35b91e7e data-v-18d75f62><button class="button" aria-label="Download" data-v-18d75f62><span class="button-text" data-v-18d75f62>下载</span><span class="right button-arrow" data-v-18d75f62></span></button><ul class="dialog" data-v-18d75f62><!--[--><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://github.com/eolinker/eoapi/releases/latest/download/eoapi-Setup-1.3.0.exe" target="_self" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Windows</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://github.com/eolinker/eoapi/releases/latest/download/eoapi-1.3.0.dmg" target="_self" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>MacOS(Intel)</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://github.com/eolinker/eoapi/releases/latest/download/eoapi-1.3.0-arm64.dmg" target="_self" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>MacOS(M1)</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><!--]--></ul></div></div><!--]--><div class="item" data-v-35b91e7e><div class="nav-dropdown-link" data-v-35b91e7e data-v-18d75f62><button class="button" data-v-18d75f62><span class="button-text" data-v-18d75f62>选择语言</span><span class="right button-arrow" data-v-18d75f62></span></button><ul class="dialog" data-v-18d75f62><!--[--><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item active" href="/api/module.html" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>简体中文</span><span class="icon" data-v-07381bdb><!----></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item" href="/en/api/module.html" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>English</span><span class="icon" data-v-07381bdb><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://github.com/eolinker/eoapi-docs" target="_blank" rel="noopener noreferrer" data-v-49fe041d>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--[--><div class="algolia-search-box" id="docsearch"></div><!--]--><!--]--></header><aside class="sidebar" data-v-17c48e2f><nav class="nav-links nav" data-v-17c48e2f data-v-35b91e7e><!--[--><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/index" data-v-49fe041d>首页 <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/docs/about" data-v-49fe041d>文档 <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item" href="/api/overview" data-v-49fe041d>API <!----></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://demo.eoapi.io/" target="_blank" rel="noopener noreferrer" data-v-49fe041d>Live Demo <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://github.com/eolinker/eoapi" target="_blank" rel="noopener noreferrer" data-v-49fe041d>Github <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="item" data-v-35b91e7e><div class="nav-dropdown-link" data-v-35b91e7e data-v-18d75f62><button class="button" aria-label="Download" data-v-18d75f62><span class="button-text" data-v-18d75f62>下载</span><span class="right button-arrow" data-v-18d75f62></span></button><ul class="dialog" data-v-18d75f62><!--[--><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://github.com/eolinker/eoapi/releases/latest/download/eoapi-Setup-1.3.0.exe" target="_self" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>Windows</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://github.com/eolinker/eoapi/releases/latest/download/eoapi-1.3.0.dmg" target="_self" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>MacOS(Intel)</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item isExternal" href="https://github.com/eolinker/eoapi/releases/latest/download/eoapi-1.3.0-arm64.dmg" target="_self" rel="noopener noreferrer" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>MacOS(M1)</span><span class="icon" data-v-07381bdb><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-07381bdb><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></span></a></div></li><!--]--></ul></div></div><!--]--><div class="item" data-v-35b91e7e><div class="nav-dropdown-link" data-v-35b91e7e data-v-18d75f62><button class="button" data-v-18d75f62><span class="button-text" data-v-18d75f62>选择语言</span><span class="right button-arrow" data-v-18d75f62></span></button><ul class="dialog" data-v-18d75f62><!--[--><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item active" href="/api/module.html" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>简体中文</span><span class="icon" data-v-07381bdb><!----></span></a></div></li><li class="dialog-item" data-v-18d75f62><div class="nav-dropdown-link-item" data-v-18d75f62 data-v-07381bdb><a class="item" href="/en/api/module.html" data-v-07381bdb><span class="arrow" data-v-07381bdb></span><span class="text" data-v-07381bdb>English</span><span class="icon" data-v-07381bdb><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-35b91e7e><div class="nav-link" data-v-35b91e7e data-v-49fe041d><a class="item isExternal" href="https://github.com/eolinker/eoapi-docs" target="_blank" rel="noopener noreferrer" data-v-49fe041d>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-49fe041d><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-17c48e2f><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/api/overview">插件</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/api/get-started">快速开始</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/api/feature-contribution/index">可贡献功能点</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/api/feature-contribution/export">导出</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/api/feature-contribution/push">推送</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/api/feature-contribution/i18n">国际化</a><!----></li></ul></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-8fcebc32><div class="container" data-v-8fcebc32><!--[--><!--]--><div style="position:relative;" class="content" data-v-8fcebc32><div><h1 id="模块开发指南" tabindex="-1">模块开发指南 <a class="header-anchor" href="#模块开发指南" aria-hidden="true">#</a></h1><p>EOAPI-Core支持自定义模块来扩展功能，支持自定义命令行模块和API模块，模块的加载以hook机制实现。</p><h2 id="模块参数说明" tabindex="-1">模块参数说明 <a class="header-anchor" href="#模块参数说明" aria-hidden="true">#</a></h2><h3 id="命令行扩展" tabindex="-1">命令行扩展 <a class="header-anchor" href="#命令行扩展" aria-hidden="true">#</a></h3><p>命令行的扩展方式是定义core__开头的函数，终端会自动加载并运行。</p><h3 id="api的hook扩展" tabindex="-1">API的Hook扩展 <a class="header-anchor" href="#api的hook扩展" aria-hidden="true">#</a></h3><p>API的hook扩展方式是定义app__{hook_name}组合的函数，那么在{hook_name}在被调用时会自动运行该函数。</p><h3 id="eo对象属性" tabindex="-1">EO对象属性 <a class="header-anchor" href="#eo对象属性" aria-hidden="true">#</a></h3><ul><li>logger 日志记录</li><li>module 模块管理</li><li>hook hook扩展</li><li>command 命令行对象</li><li>input 调用其他模块输出的源数据</li><li>output 其他模块调用处理后的返回数据</li></ul><h2 id="核心模块" tabindex="-1">核心模块 <a class="header-anchor" href="#核心模块" aria-hidden="true">#</a></h2><p>核心模块是指EOAPI-Core启动时自带的模块。</p><h3 id="核心模块开发" tabindex="-1">核心模块开发 <a class="header-anchor" href="#核心模块开发" aria-hidden="true">#</a></h3><p>1 创建文件</p><ul><li>在src/modules目录下创建模块文件夹，并创建index.ts文件。如&quot;src/modules/demo/index.ts&quot;</li></ul><p><img src="/assets/1646145146839.2eecf067.jpg" alt="demo模块"></p><p>2 模块实现</p><div class="language-typescript"><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> EOInterface<span class="token punctuation">,</span> EOModuleInterface <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../../types&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> EOModuleInterface <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">&#39;demo&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 模块标识</span>
    name<span class="token operator">:</span> <span class="token string">&#39;Demo&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 模块名称</span>
    core<span class="token operator">:</span> <span class="token string">&#39;1.x&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 模块所属核心版本</span>
    version<span class="token operator">:</span> <span class="token string">&#39;1.0.0&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 模块版本</span>
    description<span class="token operator">:</span> <span class="token string">&#39;Demo module of eo&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 模块简介</span>
    <span class="token keyword">package</span><span class="token operator">:</span> <span class="token string">&#39;Core&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 模块分类</span>
    <span class="token comment">// 扩展命令行</span>
    <span class="token function">cli__core</span><span class="token punctuation">(</span>eo<span class="token operator">:</span> EOInterface<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      eo<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">run cli__core [</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      eo<span class="token punctuation">.</span>command
        <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&#39;demo&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token string">&#39;d&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">argument</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;hook&gt;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;hook name&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&#39;display hooks description.&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">(</span>hook<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          eo<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">help of hook name </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hook<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;db_load&#39;</span> <span class="token operator">===</span> hook<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            eo<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;api扩展hook &lt;db_load&gt;测试&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            eo<span class="token punctuation">.</span><span class="token function">hookDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> eo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 实现指定的hook name &quot;db_load&quot;</span>
    <span class="token function">app__db_load</span><span class="token punctuation">(</span>eo<span class="token operator">:</span> EOInterface<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;app__db_load&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 可将处理后的数据扔回eo.output对象</span>
      eo<span class="token punctuation">.</span>output<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;demo测试数据&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> eo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> module<span class="token punctuation">;</span>
</code></pre></div><p>3 启用模块</p><p><strong>引入</strong></p><p>在文件src/lib/mobules.ts中引入模块demo</p><div class="language-typescript"><pre><code><span class="token keyword">import</span> demoModule <span class="token keyword">from</span> <span class="token string">&#39;../modules/demo&#39;</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/1646146585818.650acfca.jpg" alt="demo模块引入"></p><p><strong>启用</strong></p><p>在方法loadContributedModules加入引入的模块</p><div class="language-typescript"><pre><code>modules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">demoModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/1646146829854.85dcaacb.jpg" alt="demo模块启用"></p><p>4 测试运行</p><p><strong>编译</strong></p><p>核心模块完成后，需要重新编译核心，运行</p><div class="language-bash"><pre><code><span class="token function">npm</span> run build
</code></pre></div><p><strong>命令行演示</strong></p><div class="language-bash"><pre><code>./bin/eo demo abc
</code></pre></div><p><img src="/assets/1646148825476.b52a7c9e.jpg" alt="demo模块命令行演示"></p><p><strong>API扩展演示</strong></p><div class="language-bash"><pre><code>./bin/eo demo db_load
</code></pre></div><p><img src="/assets/1646148970180.329c2924.jpg" alt="demo模块API扩展演示"></p><h2 id="社区模块" tabindex="-1">社区模块 <a class="header-anchor" href="#社区模块" aria-hidden="true">#</a></h2><p>社区模块是指第三方基于Hook机制开发的模块，通常以eo-module-开头，并提交到NPM可以由用户自行选择安装和加载。</p><h3 id="模块创建" tabindex="-1">模块创建 <a class="header-anchor" href="#模块创建" aria-hidden="true">#</a></h3><p>模块的初始化代码可以使用eo命令或从git仓库来生成。</p><h4 id="eo命令创建" tabindex="-1">eo命令创建 <a class="header-anchor" href="#eo命令创建" aria-hidden="true">#</a></h4><div class="language-typescript"><pre><code><span class="token comment">// eo g module_name</span>
eo g demo
</code></pre></div><p>命令执行后，会在当前目录生成eo-module-demo的文件夹。在指定模块名称时，如果不是以eo-module-开头，则会自动加上前缀。</p><h4 id="git仓库创建" tabindex="-1">Git仓库创建 <a class="header-anchor" href="#git仓库创建" aria-hidden="true">#</a></h4><div class="language-bash"><pre><code><span class="token function">git</span> clone https://github.com/eolinker/eo-module-demo.git
<span class="token builtin class-name">cd</span> eo-module-demo
<span class="token function">npm</span> init
</code></pre></div><h4 id="文件结构" tabindex="-1">文件结构 <a class="header-anchor" href="#文件结构" aria-hidden="true">#</a></h4><p><img src="/assets/1646180252155.c50738ba.jpg" alt="demo模块目录结构"></p><p>目录eo-module-demo创建后，进入目录，并执行依赖的安装。</p><div class="language-bash"><pre><code><span class="token builtin class-name">cd</span> eo-module-demo
<span class="token function">npm</span> init
</code></pre></div><h3 id="模块开发" tabindex="-1">模块开发 <a class="header-anchor" href="#模块开发" aria-hidden="true">#</a></h3><p>模块的代码位于src/index.ts</p><div class="language-typescript"><pre><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token string">&#39;eo-module-demo&#39;</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&#39;EO Module Demo&#39;</span><span class="token punctuation">,</span>
    core<span class="token operator">:</span> <span class="token string">&#39;1.x&#39;</span><span class="token punctuation">,</span>
    version<span class="token operator">:</span> <span class="token string">&#39;1.0.0&#39;</span><span class="token punctuation">,</span>
    description<span class="token operator">:</span> <span class="token string">&#39;Demo module of EOAPI-Core&#39;</span><span class="token punctuation">,</span>
    <span class="token keyword">package</span><span class="token operator">:</span> <span class="token string">&#39;Community&#39;</span><span class="token punctuation">,</span>
    <span class="token function">cli__core</span><span class="token punctuation">(</span>eo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      eo<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">run cli__core [</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      eo<span class="token punctuation">.</span>command
        <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">&#39;demo&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token string">&#39;d&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">argument</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;hook&gt;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;hook name&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&#39;display hooks description.&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">(</span>hook<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          eo<span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">help of hook name </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hook<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> eo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">app__db_load</span><span class="token punctuation">(</span>eo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;app__db_load&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      eo<span class="token punctuation">.</span>output<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;test&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> eo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="命令行模块" tabindex="-1">命令行模块 <a class="header-anchor" href="#命令行模块" aria-hidden="true">#</a></h4><p>要扩展命令行功能，创建以cli__开头的函数，并建立相应的逻辑即可。EO对象属性与系统模块描述的相同。</p><h4 id="api模块" tabindex="-1">API模块 <a class="header-anchor" href="#api模块" aria-hidden="true">#</a></h4><p>要扩展API模块功能，创建app__{hook_name}组合的函数，并建立相应的逻辑即可。EO对象属性与系统模块描述的相同。</p><h4 id="自定义hook" tabindex="-1">自定义Hook <a class="header-anchor" href="#自定义hook" aria-hidden="true">#</a></h4><p>每个模块代码内可以实现自定义的hook，这样其他模块可以基于自定义的hook来扩展功能。</p><h3 id="模块测试" tabindex="-1">模块测试 <a class="header-anchor" href="#模块测试" aria-hidden="true">#</a></h3><p>在完成模块代码的开发后，需要运行build生成文件。</p><div class="language-bash"><pre><code><span class="token function">npm</span> run build
</code></pre></div><p>开发模式下可以使用npm-link方式，到用户主目录下~/.eo/下安装模块进行测试。</p><h3 id="模块发布" tabindex="-1">模块发布 <a class="header-anchor" href="#模块发布" aria-hidden="true">#</a></h3><p>模块完成后，需要发布到NPM上，这样用户就可以安装并使用模块了。</p><p>不管是手工还是自动发布，我们都需要一个npm的账号。</p><p><strong>提示</strong>：</p><ul><li>发布的包名不能和npm现有的包名重名</li><li>每次提交的版本号要比上一次的高</li></ul><h4 id="注册npm账号" tabindex="-1">注册npm账号 <a class="header-anchor" href="#注册npm账号" aria-hidden="true">#</a></h4><p>登录npm官网注册https://www.npmjs.com/signup，注意邮箱要验证，会发送验证链接到你的注册邮箱，没有验证的话是不能发布代码的。</p><h4 id="手工发布" tabindex="-1">手工发布 <a class="header-anchor" href="#手工发布" aria-hidden="true">#</a></h4><p>提示：如果你以前使用过npm淘宝镜像的下载链接，需要将下载链接先设置回来。</p><div class="language-bash"><pre><code><span class="token function">npm</span> config <span class="token builtin class-name">set</span> registry http://registry.npmjs.org
</code></pre></div><p>登录你的账号</p><div class="language-bash"><pre><code><span class="token function">npm</span> login
</code></pre></div><p>按照你注册的用户名、密码和邮箱配置好，只用配置一次即可。</p><p>账号配置好，这时候看一下package.json中author尽量与npm账户一致。 在根目录下配置账号信息，，我上传的时候发现有提示必须admin权限才能上传问题就是没在根目录下配置信息</p><p>检查是否登录成功</p><div class="language-bash"><pre><code><span class="token function">npm</span> <span class="token function">who</span> am i
</code></pre></div><p>配置成功之后就可以发布了。</p><div class="language-typescript"><pre><code>npm publish
</code></pre></div><h4 id="自动发布" tabindex="-1">自动发布 <a class="header-anchor" href="#自动发布" aria-hidden="true">#</a></h4><p>Github上支持npm publish的action，配置文件已经在模版代码里了，模版代码里的发布动作是创建release时会触发。</p><p>要做的就是将代码提交到github，再配置npm的访问token。</p><p>生成npm token</p><p>1 登录https://www.npmjs.com/，点击头像，弹出菜单，点击&quot;Access Tokens&quot;。</p><p><img src="/assets/1646182399060.c2232c96.jpg" alt="NPM Access Tokens"></p><p>2 点击按扭 &quot;Generate New Token&quot;</p><p><img src="/assets/1646182530065.60a615e2.jpg" alt="Generate New Token"></p><p>3 输出名称，Type选择Publish，最后点击按扭&quot;Generate Token&quot;生成Token。</p><p><img src="/assets/1646182677975.c70b57e6.jpg" alt="Generate Token"></p><p>4 复制生成的Token，配置到Github。</p><p><img src="/assets/1646182854152.9a5515c5.jpg" alt="New Token"></p><p>Github配置</p><p>1 登录Github，并进入到对应的仓库。</p><p>2 点击&quot;Settings&quot;进入仓库设置，点击&quot;Secrets -&gt; Actions&quot;，再点击按扭&quot;New repository secret&quot;。</p><p><img src="/assets/1646183308548.2d5be593.jpg" alt="Github"></p><p>3 输出Name &quot;npm_token&quot;，Value 就是npm生成的token信息，点击按扭&quot;Add secret&quot;创建。</p><p><img src="/assets/1646183764215.df962a90.jpg" alt="Github"></p><p>发布Release版本</p><p>上述配置成功后，那么在每次仓库发布Release时就会自动触发发布新版本到NPM了。</p></div></div><footer class="page-footer" data-v-8fcebc32 data-v-b65b4b36><div class="edit" data-v-b65b4b36><div class="edit-link" data-v-b65b4b36 data-v-55695e90><a class="link" href="https://github.com/eolinker/eoapi-docs/edit/main/api/module.md" target="_blank" rel="noopener noreferrer" data-v-55695e90>贡献此文档 <svg class="icon outbound icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-55695e90><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="updated" data-v-b65b4b36><p class="last-updated" data-v-b65b4b36 data-v-03c5f8f0><span class="prefix" data-v-03c5f8f0>最后更新:</span><span class="datetime" data-v-03c5f8f0></span></p></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"api_api.md\":\"91342c18\",\"api_feature-contribution_export.md\":\"839482a5\",\"api_feature-contribution_i18n.md\":\"a3a3a66d\",\"api_feature-contribution_index.md\":\"201057f6\",\"api_feature-contribution_push.md\":\"d1e8ea17\",\"api_get-started.md\":\"d9b0e96c\",\"api_module.md\":\"37005fae\",\"api_overview.md\":\"bb97e32d\",\"docs_faq.md\":\"d7f2ad71\",\"docs_about.md\":\"355a3578\",\"docs_apidoc.md\":\"38bda914\",\"docs_apitest.md\":\"d4de1519\",\"docs_contact.md\":\"58547d15\",\"docs_env.md\":\"b9994dfd\",\"docs_extension-export.md\":\"e2841ef6\",\"docs_extension-push.md\":\"bd92eee1\",\"docs_extensions.md\":\"77b9a748\",\"docs_mock.md\":\"a99c4ce2\",\"docs_script-function.md\":\"e3e854e4\",\"docs_storage.md\":\"4769ef46\",\"en_docs_about.md\":\"6ba6503b\",\"en_index.md\":\"eb6d6efb\",\"index.md\":\"b1728d25\"}")</script>
    <script type="module" async src="/assets/app.68c6bb90.js"></script>
    
  </body>
</html>